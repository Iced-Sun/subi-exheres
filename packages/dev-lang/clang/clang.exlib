# Copyright 2011 Bing Sun <subi.the.dream.walker@gmail.com>
# Distributed under the terms of the GNU General Public License v2

require cmake

export_exlib_phases src_install

SUMMARY="C language family frontend for LLVM"
DESCRIPTION="
Clang is an \"LLVM native\" C/C++/Objective-C compiler, which aims to deliver amazingly fast compiles
(e.g. about 3x faster than GCC when compiling Objective-C code in a debug configuration), extremely
useful error and warning messages and to provide a platform for building great source level tools.
The Clang Static Analyzer is a tool automatically finds bugs in your code, and is a great example of
the sort of tool that can be built using the Clang frontend as a library to parse C/C++ code.
"

HOMEPAGE="http://clang.llvm.org/"
DOWNLOADS="http://llvm.org/releases/${PV}/${PNV}.tar.gz"

LICENCES="UoI-NCSA"
SLOT="0"
MYOPTIONS=""

DEPENDENCIES="
    build:
        sys-devel/gcc
    build+run:
        dev-libs/llvm
    run:
        sys-devel/gcc[>=4.5]
    test:
        dev-lang/python
"

REMOTE_IDS="freshmeat:${PN}"

UPSTREAM_DOCUMENTATION="http://llvm.org/docs [[ lang = en ]]"
UPSTREAM_RELEASE_NOTES="${HOMEPAGE}/releases/${PV}/docs/ReleaseNotes.html"

CMAKE_SRC_CONFIGURE_PARAMS=(
    -DCMAKE_BUILD_TYPE:STRING=Release
    -DCMAKE_INSTALL_PREFIX:PATH=/usr
    -DBUILD_SHARED_LIBS:BOOL=true
    -DCLANG_PATH_TO_LLVM_BUILD:PATH=/usr
)

clang_src_install()
{
    keepdir /usr/include/clang/{StaticAnalyzer/{PathSensitive,BugReporter},Config}
    cmake_src_install
}

